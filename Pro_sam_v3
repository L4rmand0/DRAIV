#create database if not exists pro_sam_bw_19;
CREATE SCHEMA `pro_sam_bw_19` DEFAULT CHARACTER SET UTF8MB4; #utf8;

Use pro_sam_bw_19;

#crear campo para aceptacion de terminos y condiciones
#Campo para coordenadas
#Nivel educativo academico
#capacitaciones de conduccion
#Ingresos en salarios minimos 
#tipo de conductor
#Edad
#Gremio

create table IF NOT exists user_db(
Db_user_id bigint(10) UNSIGNED auto_increment not null,
primary key(Db_user_id),
Password_db varchar(45) not null, #Masculino 0, femenido 1 
E_mail varchar(35) UNIQUE not null,
#UNIQUE KEY E_mail (E_mail),
User_name varchar(35) UNIQUE  NOT NULL,
Lhost varchar(10) DEFAULT '@localhost' NOT NULL,
User_profile enum("User","Administrator","Evaluator") default 'User'not null,
Start_date datetime not null DEFAULT CURRENT_TIMESTAMP,
Date_operation timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
Operation enum("A","U","D") default "A" not null  ,
version double default "1" not null
)engine=INNODB, auto_increment=1400000000;

#Alter table user_db add Date_operation timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP AFTER User_profile ; 

create table IF NOT exists user_db_delta(
OLD_Db_user_id bigint(10) UNSIGNED not null,
OLD_Password_db varchar(45)  DEFAULT NULL, #Masculino 0, femenido 1 
OLD_E_mail varchar(35) DEFAULT NULL,
OLD_User_name varchar(35) DEFAULT NULL,
OLD_Lhost varchar(10) DEFAULT NULL,
OLD_User_profile enum("User","Administrator","Evaluator") DEFAULT NULL,
OLD_Start_date datetime DEFAULT NULL,
OLD_Date_operation timestamp DEFAULT NULL,
OLD_Operation enum("A","U","D") DEFAULT NULL ,
OLD_version double DEFAULT NULL,

NEW_Db_user_id bigint(10) UNSIGNED DEFAULT NULL,
NEW_Password_db varchar(45) DEFAULT NULL, 
NEW_E_mail varchar(35) DEFAULT NULL,
NEW_User_name varchar(35) DEFAULT NULL,
NEW_Lhost varchar(10) DEFAULT NULL,
NEW_User_profile enum("User","Administrator","Evaluator") DEFAULT NULL,
NEW_Start_date datetime DEFAULT NULL,
NEW_Date_operation timestamp DEFAULT NULL ,
NEW_Operation enum("A","U","D") DEFAULT NULL,
NEW_version double DEFAULT NULL
)engine=INNODB;


 #Alter table user_db  modify user_name varchar(35) UNIQUE not null;# modificar parametros
 
 
#ALTER TABLE user_db CHANGE safely_car_fieldUser_profile  User_profile enum("Master","User","Evaluator") default "User"not null;
#alter table user_db drop  E_mail;
#Alter table user_db add E_mail  varchar(35) not null; #afrer columna
#Alter table user_db add unique(E_mail);
#Alter table user_db  modify E_mail  varchar(35) not null;# modificar parametros
#Alter table user_db  modify user_name varchar(12) default "name0" not null;# modificar parametros
#Alter table user_db  modify user_profile enum("Master","User","Evaluator") default "User" not null ;# modificar parametros

create table IF NOT exists User_information( # la version 2.0 debe tener llave compuesta cedula y Empresa
DNI_id bigint(10) UNSIGNED not null, #cedula
primary key(DNI_id),
row_id bigint UNSIGNED auto_increment UNIQUE not null,
First_name varchar(70) not null,
Second_name varchar(20),
F_last_name varchar(20) not null default "NA",
S_last_name varchar(20) not null default "NA",
Gender boolean  not null, #Masculino 0, femenido 1
Education enum("Ninguno","Primaria","Secundaria","Pregrado","Postgrado","Sin información"), #DEBERÍA SER NOT NULL
E_mail_address varchar(35)  UNIQUE not null,##
address varchar(50) not null, 
Country_born enum("Colombia","Venezuela","Peru","Ecuador","Bolivia","Argentina","Brasil","Otro") not null,
City_born bigint DEFAULT 0000000000,
Admin_id bigint DEFAULT 0000000000,
City_Residence_place bigint DEFAULT 0000000000,
Department bigint DEFAULT 0000000000,
phone varchar(30) not null,
Civil_state enum("Soltero","Casado","Separado","Divorciado","Viudo","Union libre","Sin información") not null,
Current_company varchar(35) default "NA", 
Score decimal(3,2) default null,
Seguimiento varchar(800),
ws_name varchar(20) default "pro_sam_bw19" not null,
Start_date datetime not null DEFAULT CURRENT_TIMESTAMP,
Date_operation timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,   #Start_date datetime not null DEFAULT CURRENT_TIMESTAMP,
Termns_and_conditions timestamp not null DEFAULT CURRENT_TIMESTAMP,
user_id bigint(10) UNSIGNED, # Todas las tablas deben tener una columna con el identificador de la persona que ha agregado, modificado o eliminado algun registro
Operation enum("A","U","D") default "A" not null,
version double default 1 not null,	
Db_user_id bigint(10) UNSIGNED not null,#Creacion FK (PK_TablaOrigen)
constraint FK_Db_user_id #FKTabla destino_tabla origen
foreign key(Db_user_id)#PK_tabla origen
references user_db(Db_user_id)#Tablaorigen(PK)
On delete cascade
on update cascade	
)engine=INNODB;



#ALTER TABLE User_information modify Date_operation timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP ;

#ALTER TABLE User_information modify Db_user_id  bigint(10) not null;
#ALTER TABLE User_information modify Date_operation DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ;
#ALTER TABLE User_informationaa modify user_db_Db_user_idA bigint(10) not null unique ;
#CREATE TABLE tabla_ejemplo1 (fecha TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP); campo para guardar hora de actualización



CREATE TABLE User_information_DELTA (  
OLD_DNI_id bigint(10) UNSIGNED not null, #cedula
OLD_row_id bigint UNSIGNED not null,
OLD_First_name varchar(70) DEFAULT NULL,
OLD_Second_name varchar(20) DEFAULT NULL,
OLD_F_last_name varchar(20) DEFAULT NULL,
OLD_S_last_name varchar(20) DEFAULT NULL,
OLD_Gender boolean DEFAULT NULL, #Masculino 0, femenido 1
OLD_Education enum("Ninguno","Primaria","Secundaria","Pregrado","Postgrado","Sin información")DEFAULT NULL,
OLD_E_mail_address varchar(35) DEFAULT NULL,##
OLD_address varchar(50) DEFAULT NULL, 
OLD_Country_born enum("Colombia","Venezuela","Peru","Ecuador","Bolivia","Argentina","Brasil","Otro") DEFAULT NULL,
OLD_City_born bigint DEFAULT NULL,
OLD_Admin_id bigint DEFAULT NULL,
OLD_City_Residence_place bigint DEFAULT NULL,
OLD_Department bigint DEFAULT NULL,
OLD_phone varchar(15) DEFAULT NULL,
OLD_Civil_state enum("Soltero","Casado","Separado","Divorciado","Viudo","Union libre","Sin información") DEFAULT NULL,
OLD_Current_company varchar(35) DEFAULT NULL, 
OLD_Score decimal(3,2),
OLD_Seguimiento varchar(800)DEFAULT NULL,
OLD_ws_name varchar(20) default "pro_sam_bw19" DEFAULT NULL,
OLD_Start_date datetime DEFAULT NULL,
OLD_Date_operation timestamp default null,

OLD_Termns_and_conditions  time DEFAULT null,
OLD_user_id bigint(10) DEFAULT NULL,
OLD_Operation enum("A","U","D") DEFAULT NULL,
OLD_version double DEFAULT NULL,	
OLD_Db_user_id bigint(10) DEFAULT NULL,#Creacion FK (PK_TablaOrigen)

NEW_DNI_id bigint(10) UNSIGNED not null, #cedula
NEW_row_id bigint UNSIGNED not null,
NEW_First_name varchar(70) DEFAULT NULL ,
NEW_Second_name varchar(20) DEFAULT NULL ,
NEW_F_last_name varchar(20) DEFAULT NULL ,
NEW_S_last_name varchar(20) DEFAULT NULL,
NEW_Gender boolean DEFAULT NULL, #Masculino 0, femenido 1
NEW_Education enum("Ninguno","Primaria","Secundaria","Pregrado","Postgrado","Sin información")DEFAULT NULL,
NEW_E_mail_address varchar(35) DEFAULT NULL,##
NEW_address varchar(50) DEFAULT NULL, 
NEW_Country_born enum("Colombia","Venezuela","Peru","Ecuador","Bolivia","Argentina","Brasil","Otro") DEFAULT NULL,
NEW_City_born bigint DEFAULT NULL,
NEW_Admin_id bigint DEFAULT NULL,
NEW_City_Residence_place bigint DEFAULT NULL,
NEW_Department bigint DEFAULT NULL,
NEW_phone varchar(15) DEFAULT NULL,
NEW_Civil_state enum("Soltero","Casado","Separado","Divorciado","Viudo","Union libre","Sin información") DEFAULT NULL,
NEW_Current_company varchar(35) DEFAULT NULL, 
NEW_Score decimal(3,2) DEFAULT NULL,
NEW_Seguimiento varchar(800)DEFAULT NULL,
NEW_ws_name varchar(20) DEFAULT NULL,
NEW_Start_date datetime DEFAULT NULL,
NEW_Date_operation timestamp default null,
NEW_Termns_and_conditions  time DEFAULT null,
NEW_user_id bigint(10) DEFAULT NULL,
NEW_Operation enum("A","U","D") DEFAULT NULL,
NEW_version double DEFAULT NULL,	
NEW_Db_user_id bigint(10) DEFAULT NULL#Creacion FK (PK_TablaOrigen)
  )engine=INNODB;
  
  
#ALTER TABLE User_information_delta add NEW_Score double default null after NEW_Current_company;

create table IF NOT exists Image(# el el backend colocar una restriccion para subir unicamente JPG.
Image_id bigint(12) UNSIGNED auto_increment not null,
primary key(Image_id),
#row_id bigint auto_increment not null,
#UNIQUE KEY row_id (row_id),
Imagen_frontal varchar(100), #fondo blanco- jpg 32* 26 mm
Cedula_frente VARCHAR(100),
Cedula_reverso VARCHAR(100),
EPS_frente VARCHAR(100),
EPS_reverso VARCHAR(100),
Fondo_pension VARCHAR(100),
ARL VARCHAR(100),
Tarjeton_taxi VARCHAR(100),
Casco VARCHAR(100),
Foto_usuario_moto varchar(100),
Image longblob, # Es mejor guardar la imagen en el server , por el momento va en la base
Image_address varchar(255),
Size_image double,
Type_image varchar(255),
user_id bigint(10) UNSIGNED,
ws_name varchar(20) default "pro_sam_bw19" not null,
Start_date datetime not null DEFAULT CURRENT_TIMESTAMP,
Date_operation timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
Operation enum("A","U","D") default "A" not null,
version double default 1 not null,	
User_information_DNI_id bigint UNSIGNED NOT NULL UNIQUE ,#Creacion FK (PK_TablaOrigen)
constraint FKImage_User_information #FKTabla destino_tabla origen
foreign key(User_information_DNI_id)#PK_tabla origen
references User_information(DNI_id)#Tablaorigen(PK)
On update cascade

#user_db_Db_user_id bigint NOT NULL ,#Creacion FK (PK_TablaOrigen)
#constraint FKimage_user_db #FKTabla destino_tabla origen
#foreign key(user_db_Db_user_id)#PK_tabla origen
#references user_db(Db_user_id)#Tablaorigen(PK)
#On update cascade
)engine=INNODB auto_increment =100;


create table IF NOT exists Image_delta(
OLD_Image_id bigint(12) UNSIGNED not null,
OLD_Imagen_frontal varchar(100) DEFAULT NULL,
OLD_Cedula_frente VARCHAR(100) DEFAULT NULL,
OLD_Cedula_reverso VARCHAR(100) DEFAULT NULL,
OLD_EPS_frente VARCHAR(100) DEFAULT NULL,
OLD_EPS_reverso VARCHAR(100) DEFAULT NULL,
OLD_Fondo_pension VARCHAR(100) DEFAULT NULL,
OLD_ARL VARCHAR(100) DEFAULT NULL,
OLD_Tarjeton_taxi VARCHAR(100) DEFAULT NULL,
OLD_Casco VARCHAR(100) DEFAULT NULL,
OLD_Foto_usuario_moto varchar(100) DEFAULT NULL,
OLD_Image longblob DEFAULT NULL, # Es mejor guardar la imagen en el server 
OLD_Image_address varchar(255) DEFAULT NULL,
OLD_Size_image double DEFAULT NULL,
OLD_Type_image varchar(255) DEFAULT NULL,
OLD_user_id bigint(10)DEFAULT NULL,
OLD_ws_name varchar(20) DEFAULT NULL,
OLD_Start_date datetime DEFAULT NULL,
OLD_Date_operation timestamp DEFAULT NULL,
OLD_Operation enum("A","U","D") DEFAULT NULL,
OLD_version double DEFAULT NULL,	
OLD_User_information_DNI_id bigint UNSIGNED DEFAULT NULL, #Creacion FK (PK_TablaOrigen)

NEW_Image_id bigint(12) UNSIGNED not null,
NEW_Imagen_frontal varchar(100) DEFAULT NULL,
NEW_Cedula_frente VARCHAR(100) DEFAULT NULL,
NEW_Cedula_reverso VARCHAR(100) DEFAULT NULL,
NEW_EPS_frente VARCHAR(100) DEFAULT NULL,
NEW_EPS_reverso VARCHAR(100) DEFAULT NULL,
NEW_Fondo_pension VARCHAR(100) DEFAULT NULL,
NEW_ARL VARCHAR(100) DEFAULT NULL,
NEW_Tarjeton_taxi VARCHAR(100) DEFAULT NULL,
NEW_Casco VARCHAR(100) DEFAULT NULL,
NEW_Foto_usuario_moto varchar(100) DEFAULT NULL,
NEW_Image longblob DEFAULT NULL, # Es mejor guardar la imagen en el server 
NEW_Image_address varchar(255) DEFAULT NULL,
NEW_Size_image double DEFAULT NULL,
NEW_Type_image varchar(255) DEFAULT NULL,
NEW_user_id bigint(10)DEFAULT NULL,
NEW_ws_name varchar(20) DEFAULT NULL,
NEW_Start_date datetime DEFAULT NULL,
NEW_Date_operation timestamp DEFAULT NULL,
NEW_Operation enum("A","U","D") DEFAULT NULL,
NEW_version double DEFAULT NULL,	
NEW_User_information_DNI_id bigint  UNSIGNED DEFAULT NULL #Creacion FK (PK_TablaOrigen)

)engine=INNODB;

#ALTER TABLE image modify Nombre_documento enum("Cedula_frente","Cedula_reverso","EPS_frente","EPS_reverso","Fondo_pension","ARL","Tarjeton_taxi") default"Cedula_frente" ;

create table IF NOT exists Driving_licence(
Licence_id bigint UNSIGNED not null, #Cedula
primary key(Licence_id),
row_id bigint UNSIGNED auto_increment not null,
UNIQUE KEY row_id (row_id),
Licence_num varchar(20) not null, 
Country_expedition enum("Colombia","Venezuela","Argentina","Brasil","Ecuador","Bolivia","Otro") not null,
Category enum ("A1","A2","B1","B2","B3","C1", "C2" ,"C3","Otro" ) not null,
State enum("Vigente","Vencida","Suspendida") not null,
Expedition_day date not null,
Expi_date date not null,
user_id bigint(10) UNSIGNED,
ws_name varchar(20) default "pro_sam_bw19" not null,
Start_date datetime not null DEFAULT CURRENT_TIMESTAMP,
Date_operation timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
Operation enum("A","U","D") default "A" not null,
version double default 1 not null,	
User_information_DNI_id bigint UNSIGNED UNIQUE NOT NULL ,#Creacion FK (PK_TablaOrigen)
constraint FKDriving_licence_User_information #FKTabla destino_tabla origen
foreign key(User_information_DNI_id)#PK_tabla origen
references User_information(DNI_id)#Tablaorigen(PK)
On update cascade

#user_db_Db_user_id bigint NOT NULL ,#Creacion FK (PK_TablaOrigen)
#constraint FKDriving_licence_user_db #FKTabla destino_tabla origen
#foreign key(user_db_Db_user_id)#PK_tabla origen
#references user_db(Db_user_id)#Tablaorigen(PK)
#On update cascade

)engine=INNODB;


create table IF NOT exists Driving_licence_delta(
OLD_Licence_id bigint UNSIGNED not null, #Cedula
OLD_row_id bigint UNSIGNED not null,
OLD_Licence_num varchar(20) DEFAULT NULL, 
OLD_Country_expedition enum("Colombia","Venezuela","Argentina","Brasil","Ecuador","Bolivia","Otro") DEFAULT NULL,
OLD_Category enum ("A1","A2","B1" , "B2","B3","C1", "C2" ,"C3", "Otro" ) DEFAULT NULL,
OLD_State enum("Vigente","Vencida","Suspendida") DEFAULT NULL,
OLD_Expedition_day date DEFAULT NULL,
OLD_Expi_date date null,
OLD_user_id bigint(10) DEFAULT NULL,
OLD_ws_name varchar(20) default "pro_sam_bw19" DEFAULT NULL,
OLD_Start_date datetime DEFAULT NULL,
OLD_Date_operation timestamp DEFAULT NULL,
OLD_Operation enum("A","U","D") DEFAULT NULL,
OLD_version double DEFAULT NULL,	
OLD_User_information_DNI_id bigint UNSIGNED DEFAULT NULL,#Creacion FK (PK_TablaOrigen)

NEW_Licence_id bigint UNSIGNED not null, #Cedula
NEW_row_id bigint UNSIGNED not null,
NEW_Licence_num varchar(20) DEFAULT NULL, 
NEW_Country_expedition enum("Colombia","Venezuela","Argentina","Brasil","Ecuador","Bolivia","Otro") DEFAULT NULL,
NEW_Category  enum ("A1","A2","B1","B2","B3","C1", "C2" ,"C3", "Otro" ) DEFAULT NULL,
NEW_State enum("Vigente","Vencida","Suspendida") DEFAULT NULL,
NEW_Expedition_day date DEFAULT NULL,
NEW_Expi_date date null,
NEW_user_id bigint(10)DEFAULT NULL,
NEW_ws_name varchar(20) default "pro_sam_bw19" DEFAULT NULL,
NEW_Start_date datetime DEFAULT NULL,
NEW_Date_operation timestamp DEFAULT NULL,
NEW_Operation enum("A","U","D") DEFAULT NULL,
NEW_version double DEFAULT NULL,	
NEW_User_information_DNI_id bigint UNSIGNED DEFAULT NULL#Creacion FK (PK_TablaOrigen)

#user_db_Db_user_id bigint NOT NULL ,#Creacion FK (PK_TablaOrigen)
#constraint FKDriving_licence_user_db #FKTabla destino_tabla origen
#foreign key(user_db_Db_user_id)#PK_tabla origen
#references user_db(Db_user_id)#Tablaorigen(PK)
#On update cascade

)engine=INNODB;


create table IF NOT exists Vehicle(
Plate_id varchar(15) not null,
primary key(Plate_id),
row_id bigint UNSIGNED auto_increment not null,
UNIQUE KEY row_id (row_id),
Type_V enum("Carro",'Moto','Furgon','Otro'),
Owner_V boolean , # 1 si, 0 no
Taxi_type enum("Taxi amarillo","Taxi blanco","NA"),
taxi_Number_of_drivers varchar (10) default 1, #Nuevo
Soat_expi_date date not null, #MDY
Capacity int, #Número de pasajeros
Service enum("Particular","Transporte_mercancia","Transporte_publico","Otros"),
Cylindrical_cc double,
V_class varchar(20),
Model  year, # podría ser un date year
Line varchar(15),
Brand varchar(15),
Color varchar (15), #Nuevo
technomechanical_date date, #MDY 
#Name_evaluator varchar(35),#
user_id bigint(10) UNSIGNED,
ws_name varchar(20) default "pro_sam_bw19" not null,
Start_date datetime not null DEFAULT CURRENT_TIMESTAMP,
Date_operation timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP , # Cuando ingreso el primer dato a la DB
Operation enum("A","U","D") default "A" not null,
version double default 1 not null,	
User_information_DNI_id bigint UNSIGNED UNIQUE NOT NULL  ,#Creacion FK (PK_TablaOrigen)
constraint FKVehicle_User_information #FKTabla destino_tabla origen
foreign key(User_information_DNI_id)#PK_tabla origen
references User_information(DNI_id)#Tablaorigen(PK)
On update cascade
)engine=INNODB;


create table IF NOT exists Vehicle_delta(
OLD_Plate_id varchar(15)  not null,
OLD_row_id bigint UNSIGNED NOT null,
OLD_Type_V enum("Carro",'Moto','Furgon','Otro')DEFAULT NULL,
OLD_Owner_V boolean DEFAULT NULL, # 1 si, 0 no
OLD_Taxi_type enum("Taxi amarillo","Taxi blanco","NA")DEFAULT NULL,
OLD_Soat_expi_date date DEFAULT NULL, #MDY
OLD_Capacity int DEFAULT NULL, #Número de pasajeros
OLD_Service enum("Particular","Transporte_mercancia","Transporte_publico","Otros")DEFAULT NULL,
OLD_Cylindrical_cc double DEFAULT NULL,
OLD_V_class varchar(20) DEFAULT NULL,
OLD_Model  year DEFAULT NULL, # podría ser un date year
OLD_Line varchar(15) DEFAULT NULL,
OLD_Brand varchar(15) DEFAULT NULL,
OLD_Color varchar (15)  DEFAULT NULL,
OLD_technomechanical_date date DEFAULT NULL, #MDY 
#Name_evaluator varchar(35),#
OLD_user_id bigint(10) UNSIGNED,
OLD_ws_name varchar(20) DEFAULT NULL,
OLD_Start_date datetime DEFAULT NULL,
OLD_Date_operation timestamp DEFAULT NULL , # Cuando ingreso el primer dato a la DB
OLD_Operation enum("A","U","D") DEFAULT NULL,
OLD_version double DEFAULT NULL,	
OLD_User_information_DNI_id bigint UNSIGNED DEFAULT NULL,#Creacion FK (PK_TablaOrigen)
NEW_Plate_id varchar(15)  not null,
NEW_row_id bigint UNSIGNED not null,
NEW_Type_V enum("Carro",'Moto','Furgon','Otro')DEFAULT NULL,
NEW_Owner_V boolean DEFAULT NULL, # 1 si, 0 no
NEW_Taxi_type enum("Taxi amarillo","Taxi blanco","NA")DEFAULT NULL,
NEW_Soat_expi_date date DEFAULT NULL, #MDY
NEW_Capacity int DEFAULT NULL, #Número de pasajeros
NEW_Service enum("Particular","Transporte_mercancia","Transporte_publico","Otros")DEFAULT NULL,
NEW_Cylindrical_cc double DEFAULT NULL,
NEW_V_class varchar(20) DEFAULT NULL,
NEW_Model  year DEFAULT NULL, # podría ser un date year
NEW_Line varchar(15) DEFAULT NULL,
NEW_Brand varchar(15) DEFAULT NULL,
NEW_Color varchar (15) DEFAULT NULL,
NEW_technomechanical_date date DEFAULT NULL, #MDY 
#Name_evaluator varchar(35),#
NEW_user_id bigint(10) DEFAULT NULL,
NEW_ws_name varchar(20) DEFAULT NULL,
NEW_Start_date datetime DEFAULT NULL,
NEW_Date_operation timestamp DEFAULT NULL , # Cuando ingreso el primer dato a la DB
NEW_Operation enum("A","U","D") DEFAULT NULL,
NEW_version double DEFAULT NULL,	
NEW_User_information_DNI_id bigint UNSIGNED DEFAULT NULL#Creacion FK (PK_TablaOrigen)

)engine=INNODB;


create table IF NOT exists taxí(
row_id bigint UNSIGNED auto_increment not null,
key(row_id),
Number_drivers_ varchar (5),
Driver1 varchar (35),
Driver2 varchar (35),
Driver3 varchar (35),
Driver4 varchar (35),
Driver5 varchar (35),
Plate varchar (35),
year_id date,
Company varchar (35)
)engine=INNODB;



#ALTER TABLE Vehicle DROP FOREIGN KEY FKVehicle_User_information; 

create table IF NOT exists Vehicle_evaluation(
# El modelo permite evaluar el mismo carro dos veces o mas en el mismo año
Vehicle_evaluation_id  bigint  UNSIGNED auto_increment  not null, 
UNIQUE KEY Vehicle_evaluation_id (Vehicle_evaluation_id),
#row_id bigint unsigned auto_increment not null, 
#UNIQUE KEY row_id (row_id),
Date_evaluation DATE not null, #CREAR UN TRIGGER PARA METER EÑ VALOR POR DEFAUT  
primary key(Date_evaluation,Vehicle_Plate_id),
Evaluator_name varchar(25),
V_class_value int(5) UNSIGNED, #CHECK (V_class_value<=5),
Soat_value int(5) UNSIGNED, #CHECK (Soat_value<=5),
Brand_value int(5) UNSIGNED,  #CHECK(Brand_value<=5),
technomechanical_value int(5) UNSIGNED,  #CHECK(technomechanical_value<=5),
Model_value int(5) UNSIGNED, #CHECK (Model_value<=5),
Line_value int(5) UNSIGNED, #CHECK (Line_value<=5),
Cylindrical_value int(5) UNSIGNED,  #CHECK(Cylindrical_value<=5),
V_Results int(5),
Docs json NULL, #link para guardar los datos: Debe existir un campo para cada documento
user_id bigint(10) UNSIGNED,
ws_name varchar(20) default "pro_sam_bw19" not null,
Start_date datetime not null DEFAULT CURRENT_TIMESTAMP,
Date_operation timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, # Cuando ingreso el primer dato a la DB
Operation enum("A","U","D") default "A" not null,
version double default 1 not null,	
CONSTRAINT CHK_Values CHECK (V_class_value<=5 AND Soat_value<=5 AND Brand_value<=5 AND technomechanical_value<=5 AND Model_value<=5 AND Line_value<=5 AND Cylindrical_value<=5),

Vehicle_Plate_id varchar(15) NOT NULL ,#Creacion FK (PK_TablaOrigen)
constraint FKVehicle_evaluation_Vehicle #FKTabla destino_tabla origen
foreign key(Vehicle_Plate_id)#PK_tabla origen
references Vehicle(Plate_id)#Tablaorigen(PK)
On update cascade/*,
user_db_Db_user_id bigint  NOT NULL ,#Creacion FK (PK_TablaOrigen)
constraint FKVehicle_evaluation_user_db #FKTabla destino_tabla origen
foreign key(user_db_Db_user_id)#PK_tabla origen
references user_db(Db_user_id)#Tablaorigen(PK)
On update cascade*/
)engine=INNODB, auto_increment=1;
#Alter table Vehicle_evaluation  modify Docs json NULL;# modificar parametros

create table IF NOT exists Vehicle_evaluation_delta(
OLD_Vehicle_evaluation_id bigint UNSIGNED not null, 
#OLD_row_id bigint unsigned not null,
OLD_Date_evaluation DATE not null,
OLD_Evaluator_name varchar(25) DEFAULT NULL,
OLD_V_class_value int(5) UNSIGNED DEFAULT NULL, 
OLD_Soat_value int(5) UNSIGNED DEFAULT NULL, 
OLD_Brand_value int(5) UNSIGNED DEFAULT NULL,
OLD_technomechanical_value int(5) UNSIGNED DEFAULT  NULL, 
OLD_Model_value int(5) UNSIGNED DEFAULT NULL,
OLD_Line_value int(5) UNSIGNED DEFAULT NULL,
OLD_Cylindrical_value int(5) UNSIGNED DEFAULT NULL, 
OLD_V_Results int(5) DEFAULT NULL,
OLD_Docs json NULL, #link para guardar los datos: Debe existir un campo para cada documento
OLD_user_id bigint(10) DEFAULT NULL,
OLD_ws_name varchar(20) DEFAULT NULL,
OLD_Start_date datetime default null,
OLD_Date_operation timestamp DEFAULT NULL, # Cuando ingreso el primer dato a la DB
OLD_Operation enum("A","U","D") DEFAULT NULL,
OLD_version double NULL,	
OLD_Vehicle_Plate_id varchar(15) DEFAULT NULL, #Creacion FK (PK_TablaOrigen)

NEW_Vehicle_evaluation_id bigint UNSIGNED not null, 
#NEW_row_id bigint unsigned not null,
NEW_date_evaluation DATE not null,
NEW_Evaluator_name varchar(25) DEFAULT NULL,
NEW_V_class_value int(5) UNSIGNED DEFAULT NULL, 
NEW_Soat_value int(5) UNSIGNED DEFAULT NULL, 
NEW_Brand_value int(5) UNSIGNED DEFAULT NULL,
NEW_technomechanical_value int(5)DEFAULT  NULL, 
NEW_Model_value int(5) UNSIGNED DEFAULT NULL,
NEW_Line_value int(5) UNSIGNED DEFAULT NULL,
NEW_Cylindrical_value int(5) UNSIGNED DEFAULT NULL, 
NEW_V_Results int(5) DEFAULT NULL,
NEW_Docs json DEFAULT NULL, #link para guardar los datos: Debe existir un campo para cada documento
NEW_user_id bigint(10) DEFAULT NULL,
NEW_ws_name varchar(20) DEFAULT NULL,
NEW_Start_date datetime DEFAULT NULL,
NEW_Date_operation timestamp DEFAULT NULL, # Cuando ingreso el primer dato a la DB
NEW_Operation enum("A","U","D") DEFAULT NULL,
NEW_version double DEFAULT NULL,	
NEW_Vehicle_Plate_id varchar(15) DEFAULT NULL #Creacion FK (PK_TablaOrigen)
)engine=INNODB;


create table IF NOT exists Safely_car_field(
Safely_car_Id  bigint UNSIGNED auto_increment not null, #Cedula
#row_id bigint UNSIGNED auto_increment not null,
UNIQUE KEY Safely_car_Id (Safely_car_Id),
primary key(Vehicle_Plate_id,Date_evaluation),
Date_evaluation DATE not null,
Brake_verification int(5) UNSIGNED,
Batery_and_connections int(5) UNSIGNED,
Chair_steering_wheel int(5) UNSIGNED,
Petron_Oil_level int(5) UNSIGNED, 
Safety_belt int(5) UNSIGNED,
Mirror int(5) UNSIGNED,
Lights int(5) UNSIGNED,
P_tires int(5) UNSIGNED,
S_tires int(5) UNSIGNED,
Coolant int(5) UNSIGNED,
C_Results int(5) UNSIGNED,
user_id bigint(10) UNSIGNED,
ws_name varchar(20) default "pro_sam_bw19" not null,
Start_date datetime not null DEFAULT CURRENT_TIMESTAMP,
Date_operation timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, # Cuando ingreso el primer dato a la DB
Operation enum("A","U","D") default "A" not null,
version double default 1 not null,	
CONSTRAINT CHK_Valuesc CHECK (Brake_verification<=5 AND Batery_and_connections<=5 AND Chair_steering_wheel <=5 AND Petron_Oil_level<=5 AND Safety_belt<=5 AND Mirror<=5 AND Lights<=5
AND P_tires<=5 AND S_tires<=5 AND Coolant<=5),
Vehicle_Plate_id varchar(15) NOT NULL ,#Creacion FK (PK_TablaOrigen)
constraint FKSafely_car_Vehicle #FKTabla destino_tabla origen
foreign key(Vehicle_Plate_id)#PK_tabla origen
references Vehicle(Plate_id)#Tablaorigen(PK)
On update cascade/*,
user_db_Db_user_id bigint NOT NULL ,#Creacion FK (PK_TablaOrigen)
constraint FKsafely_car_user_db #FKTabla destino_tabla origen
foreign key(user_db_Db_user_id)#PK_tabla origen
references user_db(Db_user_id)#Tablaorigen(PK)
On update cascade*/
)engine=INNODB;

create table IF NOT exists Safely_car_field_delta(
OLD_Safely_car_Id  bigint UNSIGNED not null, #Cedula
#OLD_row_id bigint UNSIGNED not null,
OLD_Date_evaluation DATE not null,
OLD_Brake_verification int(5) UNSIGNED DEFAULT NULL,
OLD_Batery_and_connections int(5) UNSIGNED DEFAULT NULL,
OLD_Chair_steering_wheel int(5) UNSIGNED DEFAULT NULL,
OLD_Petron_Oil_level int(5) UNSIGNED DEFAULT NULL, 
OLD_Safety_belt int(5) UNSIGNED DEFAULT NULL,
OLD_Mirror int(5) UNSIGNED DEFAULT NULL,
OLD_Lights int(5) UNSIGNED DEFAULT NULL,
OLD_P_tires int(5) UNSIGNED DEFAULT NULL,
OLD_S_tires int(5) UNSIGNED DEFAULT NULL,
OLD_Coolant int(5) UNSIGNED DEFAULT NULL,
OLD_C_Results int(5) DEFAULT NULL,
OLD_user_id bigint(10) DEFAULT NULL,
OLD_ws_name varchar(20) DEFAULT NULL,
OLD_Start_date datetime DEFAULT NULL,
OLD_Date_operation timestamp   DEFAULT NULL ,
OLD_Operation enum("A","U","D")  DEFAULT NULL,
OLD_version double DEFAULT NULL,	
OLD_Vehicle_Plate_id varchar(15)  DEFAULT NULL,

NEW_Safely_car_Id  bigint UNSIGNED not null, #Cedula
#NEW_row_id bigint UNSIGNED not null,
NEW_Date_evaluation DATE not null,
NEW_Brake_verification int(5) UNSIGNED DEFAULT NULL,
NEW_Batery_and_connections int(5) UNSIGNED DEFAULT NULL,
NEW_Chair_steering_wheel int(5) UNSIGNED DEFAULT NULL,
NEW_Petron_Oil_level int(5) UNSIGNED DEFAULT NULL, 
NEW_Safety_belt int(5) UNSIGNED DEFAULT NULL,
NEW_Mirror int(5) UNSIGNED DEFAULT NULL,
NEW_Lights int(5) UNSIGNED DEFAULT NULL,
NEW_P_tires int(5) UNSIGNED DEFAULT NULL,
NEW_S_tires int(5) UNSIGNED DEFAULT NULL,
NEW_Coolant int(5) UNSIGNED DEFAULT NULL,
NEW_C_Results int(5) DEFAULT NULL,
NEW_user_id bigint(10) DEFAULT NULL,
NEW_ws_name varchar(20) DEFAULT NULL,
NEW_Start_date datetime DEFAULT NULL,
NEW_Date_operation timestamp   DEFAULT NULL ,
NEW_Operation enum("A","U","D")  DEFAULT NULL,
NEW_version double DEFAULT NULL,	
NEW_Vehicle_Plate_id varchar(15)  DEFAULT NULL
)engine=INNODB;

#ALTER TABLE Safely_car_field DROP FOREIGN KEY FKSafely_car_Vehicle; 


create table IF NOT exists Motorcycle_Technology(  #Nuevo Falta crear el delta.
M_t_id bigint UNSIGNED auto_increment not null,
UNIQUE M_t_id (M_t_id),
Date_evaluation DATE not null,
primary key(Vehicle_Plate_id,Date_evaluation),
Breake_type int UNSIGNED,
Assistence_breake int UNSIGNED,
Automatic_lights int UNSIGNED,
user_id bigint(10) UNSIGNED,
ws_name varchar(20) default "pro_sam_bw19" not null,
Start_date datetime not null DEFAULT CURRENT_TIMESTAMP,
Date_operation timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
Operation enum("A","U","D") default "A" not null,
version double default 1 not null,	
CONSTRAINT Mot_tech_Valuesm CHECK (Breake_type<=4 AND Assistence_breake<=5 AND Automatic_lights<=1),

Vehicle_Plate_id varchar(15) NOT NULL ,#Creacion FK (PK_TablaOrigen)
constraint FKMotorcycle_Technology_Vehicle #FKTabla destino_tabla origen
foreign key(Vehicle_Plate_id)#PK_tabla origen
references Vehicle(Plate_id)#Tablaorigen(PK)
On update cascade
)engine=INNODB;


create table IF NOT exists Motorcycle_Technology_delta(  #Nuevo Falta crear el delta.
OLD_M_t_id bigint UNSIGNED not null,
OLD_Date_evaluation DATE DEFAULT NULL,
OLD_Breake_type int UNSIGNED DEFAULT NULL,
OLD_Assistence_breake int UNSIGNED DEFAULT NULL,
OLD_Automatic_lights int UNSIGNED DEFAULT NULL,
OLD_user_id bigint(10) UNSIGNED DEFAULT NULL,
OLD_ws_name varchar(20) DEFAULT NULL,
OLD_Start_date datetime DEFAULT NULL,
OLD_Date_operation timestamp DEFAULT NULL,
OLD_Operation enum("A","U","D") DEFAULT NULL,
OLD_version double default 1 DEFAULT NULL,
OLD_Vehicle_Plate_id varchar(15) DEFAULT NULL,#Creacion FK (PK_TablaOrigen)

NEW_M_t_id bigint UNSIGNED not null,
NEW_Date_evaluation DATE DEFAULT NULL,
NEW_Breake_type int UNSIGNED DEFAULT NULL,
NEW_Assistence_breake int UNSIGNED DEFAULT NULL,
NEW_Automatic_lights int UNSIGNED DEFAULT NULL,
NEW_user_id bigint(10) UNSIGNED DEFAULT NULL,
NEW_ws_name varchar(20) DEFAULT NULL,
NEW_Start_date datetime DEFAULT NULL,
NEW_Date_operation timestamp DEFAULT NULL,
NEW_Operation enum("A","U","D") DEFAULT NULL,
NEW_version double default 1 DEFAULT NULL,
NEW_Vehicle_Plate_id varchar(15) DEFAULT NULL#Creacion FK (PK_TablaOrigen)
)engine=INNODB;



create table IF NOT exists Motorcycle_Mechanical_conditions( # Cambio
Evaluation_Id bigint UNSIGNED auto_increment not null, #cedula
UNIQUE KEY Evaluation_Id (Evaluation_Id),
primary key(Vehicle_Plate_id,Date_evaluation),
#row_id bigint UNSIGNED auto_increment not null,
#UNIQUE KEY row_id (row_id),
Date_evaluation DATE not null,
Name_evaluator varchar(35),
Tires double UNSIGNED,
Manigueta_guaya double UNSIGNED,
Braking_system double UNSIGNED,
Kit double UNSIGNED,
Stee_Susp double UNSIGNED,
Oil_leak double UNSIGNED,
Other_components double UNSIGNED,
Horn double UNSIGNED,
Lights double UNSIGNED,
M_Results double, #valor total para las motos
user_id bigint(10) UNSIGNED,
ws_name varchar(20) default "pro_sam_bw19" not null,
Start_date datetime not null DEFAULT CURRENT_TIMESTAMP,
Date_operation timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
Operation enum("A","U","D") default "A" not null,
version double default 1 not null,	

CONSTRAINT CHK_Valuesm CHECK (Tires<=3 AND Manigueta_guaya<=3 AND Braking_system<=3 AND Kit<=3 AND Stee_Susp<=3
AND Oil_leak<=3 AND Other_components<=3  AND Horn<=2 AND Lights<=3 ),    #cambios

Vehicle_Plate_id varchar(15) NOT NULL ,#Creacion FK (PK_TablaOrigen)
constraint FKmotorcycle_mechanical_Vehicle #FKTabla destino_tabla origen
foreign key(Vehicle_Plate_id)#PK_tabla origen
references Vehicle(Plate_id)#Tablaorigen(PK)
On update cascade/*,
user_db_Db_user_id bigint NOT NULL ,#Creacion FK (PK_TablaOrigen)
constraint FKmotorcycle_mechanical_user_db #FKTabla destino_tabla origen
foreign key(user_db_Db_user_id)#PK_tabla origen
references user_db(Db_user_id)#Tablaorigen(PK)
On update cascade #Cuidado con ek valor not null del User_db*/
)engine=INNODB;


#ALTER TABLE Motorcycle_Mechanical_conditions DROP FOREIGN KEY FKmotorcycle_mechanical_user_db; 


create table IF NOT exists Motorcycle_Mechanical_conditions_delta(
OLD_Evaluation_Id bigint UNSIGNED not null, #cedula
#OLD_row_id bigint UNSIGNED not null,
OLD_Date_evaluation DATE not null,
OLD_Name_evaluator varchar(35) DEFAULT NULL,
OLD_Tires double UNSIGNED DEFAULT NULL,
OLD_Manigueta_guaya double UNSIGNED  DEFAULT NULL,
OLD_Braking_system double UNSIGNED  DEFAULT NULL,
OLD_Kit double UNSIGNED  DEFAULT NULL,
OLD_Stee_Susp double UNSIGNED  DEFAULT NULL,
OLD_Oil_leak double UNSIGNED  DEFAULT NULL,
OLD_Other_components double UNSIGNED  DEFAULT NULL,
OLD_Horn double UNSIGNED  DEFAULT NULL,
OLD_Lights double UNSIGNED  DEFAULT NULL,
OLD_M_Results double DEFAULT NULL, #valor total para las motos
OLD_user_id bigint(10) DEFAULT NULL,
OLD_ws_name varchar(20) DEFAULT NULL,
OLD_Start_date datetime DEFAULT NULL,
OLD_Date_operation timestamp NULL ,
OLD_Operation enum("A","U","D") DEFAULT NULL,
OLD_version double DEFAULT NULL,	
OLD_Vehicle_Plate_id varchar(15) NOT NULL,

NEW_Evaluation_Id bigint UNSIGNED not null, #cedula
#NEW_row_id bigint UNSIGNED  not null,
NEW_Date_evaluation  DATE not null,
NEW_Name_evaluator varchar(35) DEFAULT NULL,
NEW_Tires double UNSIGNED DEFAULT NULL,
NEW_Manigueta_guaya double UNSIGNED DEFAULT NULL,
NEW_Braking_system double UNSIGNED DEFAULT NULL,
NEW_Kit double UNSIGNED DEFAULT NULL,
NEW_Stee_Susp double UNSIGNED DEFAULT NULL,
NEW_Oil_leak double UNSIGNED DEFAULT NULL,
NEW_Other_components double UNSIGNED DEFAULT NULL,
NEW_Horn double UNSIGNED DEFAULT NULL,
NEW_Lights double UNSIGNED DEFAULT NULL,
NEW_M_Results double DEFAULT NULL, #valor total para las motos
NEW_user_id bigint(10) DEFAULT NULL,
NEW_ws_name varchar(20) DEFAULT NULL,
NEW_Start_date datetime DEFAULT NULL,
NEW_Date_operation timestamp NULL,
NEW_Operation enum("A","U","D") DEFAULT NULL,
NEW_version double DEFAULT NULL,	
NEW_Vehicle_Plate_id varchar(15) DEFAULT NULL
)engine=INNODB;


create table IF NOT exists EPP(
Epp_id bigint UNSIGNED not null auto_increment, #revisar
UNIQUE KEY Epp_id (Epp_id),
primary key(User_information_DNI_id, Date_evaluation),
#row_id bigint auto_increment not null,
#UNIQUE KEY row_id (row_id),
Date_evaluation DATE not null,
Name_evaluator varchar(35),#
Empresa varchar(30),#
Casco int UNSIGNED,    
Airbag int UNSIGNED,
Rodilleras int UNSIGNED,
Coderas int UNSIGNED,
Hombreras int UNSIGNED,
Espalda int UNSIGNED ,#NUEVO
Botas int UNSIGNED,
Guantes int UNSIGNED,
Epp_Results int,
Risk enum("Alto","Medio","Bajo"),
user_id bigint(10) UNSIGNED,
ws_name varchar(20) default "pro_sam_bw19" not null,
Start_date datetime not null DEFAULT CURRENT_TIMESTAMP,
Date_operation timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
Operation enum("A","U","D") default "A" not null,
version double default 1 not null,	
CONSTRAINT CHK_Valuesepp CHECK (Casco <=3 AND Airbag<=3 AND Rodilleras<=1 AND Coderas<=1 AND Hombreras<=1  AND Espalda <=1
AND Botas<=1 AND Guantes<=1), #Nuevo
User_information_DNI_id bigint UNSIGNED NOT NULL ,#Creacion FK (PK_TablaOrigen)
constraint FKEPP_User_information #FKTabla destino_tabla origen
foreign key(User_information_DNI_id)#PK_tabla origen
references User_information(DNI_id)#Tablaorigen(PK)
On update cascade/*,
user_db_Db_user_id bigint NOT NULL ,#Creacion FK (PK_TablaOrigen)
constraint FKEPP_user_db #FKTabla destino_tabla origen
foreign key(user_db_Db_user_id)#PK_tabla origen
references user_db(Db_user_id)#Tablaorigen(PK)
On update cascade #Cuidado con ek valor not null del User_db*/
)engine=INNODB;

create table IF NOT exists EPP_delta(
OLD_Epp_id bigint UNSIGNED not null, #revisar
OLD_Date_evaluation DATE not null,
OLD_Name_evaluator varchar(35) DEFAULT NULL,#
OLD_Empresa varchar(30) DEFAULT NULL,
OLD_Casco int UNSIGNED DEFAULT NULL,
OLD_Airbag int UNSIGNED DEFAULT NULL,
OLD_Rodilleras int UNSIGNED DEFAULT NULL,
OLD_Coderas int UNSIGNED DEFAULT NULL,
OLD_Hombreras int UNSIGNED DEFAULT NULL,
OLD_Botas int UNSIGNED DEFAULT NULL,
OLD_Guantes int UNSIGNED DEFAULT NULL,
OLD_Epp_Results int DEFAULT NULL,
OLD_Risk enum("Alto","Medio","Bajo") DEFAULT NULL, 
OLD_user_id bigint(10) DEFAULT NULL,
OLD_ws_name varchar(20) default "pro_sam_bw19" DEFAULT NULL,
OLD_Start_date datetime DEFAULT NULL,
OLD_Date_operation timestamp DEFAULT NULL,
OLD_Operation enum("A","U","D") DEFAULT NULL,
OLD_version double DEFAULT NULL,	
OLD_User_information_DNI_id bigint UNSIGNED DEFAULT NULL, #Creacion FK (PK_TablaOrigen)

NEW_Epp_id bigint UNSIGNED not null, #revisar
NEW_Date_evaluation DATE not null,
NEW_Name_evaluator varchar(35) DEFAULT NULL,#
NEW_Empresa varchar(30) DEFAULT NULL,
NEW_Casco int UNSIGNED DEFAULT NULL,
NEW_Airbag int UNSIGNED DEFAULT NULL,
NEW_Rodilleras int UNSIGNED DEFAULT NULL,
NEW_Coderas int UNSIGNED DEFAULT NULL,
NEW_Hombreras int UNSIGNED DEFAULT NULL,
NEW_Botas int UNSIGNED DEFAULT NULL,
NEW_Guantes int UNSIGNED DEFAULT NULL,
NEW_Epp_Results int DEFAULT NULL,
NEW_Risk enum("Alto","Medio","Bajo") DEFAULT NULL, 
NEW_user_id bigint(10) DEFAULT NULL,
NEW_ws_name varchar(20) default "pro_sam_bw19" DEFAULT NULL,
NEW_Start_date datetime DEFAULT NULL,
NEW_Date_operation timestamp DEFAULT NULL,
NEW_Operation enum("A","U","D") DEFAULT NULL,
NEW_version double DEFAULT NULL,	
NEW_User_information_DNI_id bigint UNSIGNED DEFAULT NULL #Creacion FK (PK_TablaOrigen)
)engine=INNODB;


create table IF NOT exists Skill_m_t_m(
Reg_id bigint UNSIGNED not null auto_increment, #revisar
UNIQUE KEY Reg_id (Reg_id),
primary key(User_information_DNI_id,Date_evaluation),
Date_evaluation DATE not null,
#row_id bigint auto_increment not null,
#UNIQUE KEY row_id (row_id),
Slalom int UNSIGNED,
Projection int UNSIGNED,
Braking int UNSIGNED,
Evasion int UNSIGNED,
Mobility int UNSIGNED,# Por el momento no va a ser usado.
Result int,
user_id bigint(10) UNSIGNED,
ws_name varchar(20) default "pro_sam_bw19" not null,
Start_date datetime not null DEFAULT CURRENT_TIMESTAMP,
Date_operation timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
Operation enum("A","U","D") default "A" not null,
version double default 1 not null,	

CONSTRAINT CHK_Valuesmtm CHECK (Slalom <=1 AND Projection<=3 AND Braking<=3 AND Evasion<=3 AND Mobility<=3), #nuevo

User_information_DNI_id bigint UNSIGNED NOT NULL ,#Creacion FK (PK_TablaOrigen)
constraint FKskill_m_t_m_User_information #FKTabla destino_tabla origen
foreign key(User_information_DNI_id)#PK_tabla origen
references User_information(DNI_id)#Tablaorigen(PK)
On update cascade/*,
user_db_Db_user_id bigint NOT NULL ,#Creacion FK (PK_TablaOrigen)
constraint FKskill_m_t_m_user_db #FKTabla destino_tabla origenPRIMARY
foreign key(user_db_Db_user_id)#PK_tabla origen
references user_db(Db_user_id)#Tablaorigen(PK)
On update cascade #Cuidado con ek valor not null del User_db*/
)engine=INNODB;


create table IF NOT exists Skill_m_t_m_delta(
OLD_Reg_id bigint UNSIGNED not null, #revisar
OLD_Date_evaluation DATE not null,
OLD_Slalom int UNSIGNED DEFAULT NULL,
OLD_Projection int UNSIGNED DEFAULT NULL,
OLD_Braking int UNSIGNED DEFAULT NULL,
OLD_Evasion int UNSIGNED DEFAULT NULL,
OLD_Mobility int  UNSIGNED DEFAULT NULL,
OLD_Result int  DEFAULT NULL,
OLD_user_id bigint(10) DEFAULT NULL,
OLD_ws_name varchar(20) DEFAULT NULL,
OLD_Start_date datetime DEFAULT NULL,
OLD_Date_operation timestamp DEFAULT NULL,
OLD_Operation enum("A","U","D") DEFAULT NULL,
OLD_version double DEFAULT NULL,	
OLD_User_information_DNI_id bigint UNSIGNED DEFAULT NULL, #Creacion FK (PK_TablaOrigen)

NEW_Reg_id bigint UNSIGNED not null, #revisar
NEW_Date_evaluation DATE not null,
NEW_Slalom int UNSIGNED DEFAULT NULL,
NEW_Projection int  UNSIGNED DEFAULT NULL,
NEW_Braking int UNSIGNED DEFAULT NULL,
NEW_Evasion int UNSIGNED DEFAULT NULL,
NEW_Mobility int UNSIGNED DEFAULT NULL,
NEW_Result int DEFAULT NULL,
NEW_user_id bigint(10) DEFAULT NULL,
NEW_ws_name varchar(20) DEFAULT NULL,
NEW_Start_date datetime DEFAULT NULL,
NEW_Date_operation timestamp DEFAULT NULL,
NEW_Operation enum("A","U","D") DEFAULT NULL,
NEW_version double DEFAULT NULL,	
NEW_User_information_DNI_id bigint UNSIGNED DEFAULT NULL #Creacion FK (PK_TablaOrigen)
)engine=INNODB;


create table IF NOT exists Skill_m_t_c(
Reg_id_c bigint UNSIGNED not null auto_increment, #unsigned mejora el rendimiento al quitar negativos
UNIQUE KEY Reg_id_c (Reg_id_c),
primary key(User_information_DNI_id,Date_evaluation),
#row_id bigint auto_increment not null,
#UNIQUE KEY row_id (row_id),
Date_evaluation DATE not null,
Parking int UNSIGNED,
Turn_and_overtaking int UNSIGNED,
Reverse_c int UNSIGNED,
Break int UNSIGNED,
Gear_change int UNSIGNED,
Slope int UNSIGNED,
Result int UNSIGNED,
user_id bigint(10) UNSIGNED,
ws_name varchar(20) default "pro_sam_bw19" not null,
Start_date datetime not null DEFAULT CURRENT_TIMESTAMP,
Date_operation timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
Operation enum("A","U","D") default "A" not null,
version double default 1 not null,	
CONSTRAINT CHK_Valuesmtc CHECK (Parking <=5 AND Turn_and_overtaking<=5 AND Reverse_c<=5 AND Break<=5 AND Gear_change<=5 AND Slope<=5),

User_information_DNI_id bigint UNSIGNED NOT NULL ,#Creacion FK (PK_TablaOrigen)
constraint FKskill_m_t_c_User_information #FKTabla destino_tabla origen
foreign key(User_information_DNI_id)#PK_tabla origen
references User_information(DNI_id)#Tablaorigen(PK)
On update cascade/*,
user_db_Db_user_id bigint NOT NULL ,#Creacion FK (PK_TablaOrigen)
constraint FKskill_m_t_c_user_db #FKTabla destino_tabla origen
foreign key(user_db_Db_user_id)#PK_tabla origen
references user_db(Db_user_id)#Tablaorigen(PK)
On update cascade #Cuidado con ek valor not null del User_db
*/
)engine=INNODB;

create table IF NOT exists Skill_m_t_c_delta(
OLD_Reg_id_c bigint UNSIGNED not null, #unsigned mejora el rendimiento al quitar negativos
OLD_Date_evaluation DATE not null,
OLD_Parking int UNSIGNED DEFAULT NULL,
OLD_Turn_and_overtaking int UNSIGNED DEFAULT NULL,
OLD_Reverse_c int UNSIGNED DEFAULT NULL,
OLD_Break int UNSIGNED DEFAULT NULL,
OLD_Gear_change int UNSIGNED DEFAULT NULL,
OLD_Slope int UNSIGNED DEFAULT NULL,
OLD_Result int DEFAULT NULL,
OLD_user_id bigint(10) DEFAULT NULL,
OLD_ws_name varchar(20) DEFAULT NULL,
OLD_Start_date datetime DEFAULT NULL,
OLD_Date_operation timestamp DEFAULT NULL,
OLD_Operation enum("A","U","D") DEFAULT NULL,
OLD_version double DEFAULT NULL,	
OLD_User_information_DNI_id bigint UNSIGNED DEFAULT NULL, #Creacion FK (PK_TablaOrigen)

NEW_Reg_id_c bigint UNSIGNED not null, #unsigned mejora el rendimiento al quitar negativos
NEW_Date_evaluation DATE not null,
NEW_Parking int UNSIGNED DEFAULT NULL,
NEW_Turn_and_overtaking int UNSIGNED DEFAULT NULL,
NEW_Reverse_c int UNSIGNED DEFAULT NULL,
NEW_Break int UNSIGNED DEFAULT NULL,
NEW_Gear_change int UNSIGNED DEFAULT NULL,
NEW_Slope int UNSIGNED DEFAULT NULL,
NEW_Result int DEFAULT NULL,
NEW_user_id bigint(10)  DEFAULT NULL,
NEW_ws_name varchar(20) DEFAULT NULL,
NEW_Start_date datetime DEFAULT NULL,
NEW_Date_operation timestamp DEFAULT NULL,
NEW_Operation enum("A","U","D") DEFAULT NULL,
NEW_version double DEFAULT NULL,	
NEW_User_information_DNI_id bigint UNSIGNED DEFAULT NULL #Creacion FK (PK_TablaOrigen)

)engine=INNODB;


create table IF NOT exists Drive_Behaviors_car(
Drive_beh_id bigint UNSIGNED auto_increment not null,
UNIQUE KEY Drive_beh_id (Drive_beh_id),
Date_evaluation DATE not null,
primary key(User_information_DNI_id,Date_evaluation),
#row_id bigint auto_increment not null,
#UNIQUE KEY row_id (row_id),
Stop_distance int UNSIGNED,
Roundabouts int UNSIGNED,
Follow_distance int UNSIGNED,
Overtaking_Lane_changes int UNSIGNED,
Cross_c int UNSIGNED,
Speed int UNSIGNED,
Aggressive_bhvior int UNSIGNED,
Result int,
user_id bigint(10) UNSIGNED,
ws_name varchar(20) default "pro_sam_bw19" not null ,
Start_date datetime not null DEFAULT CURRENT_TIMESTAMP,
Date_operation timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
Operation enum("A","U","D") default "A" not null,
version double default 1 not null,	
CONSTRAINT CHK_Valuesbhs CHECK (Stop_distance <=5 AND Roundabouts<=5 AND Follow_distance<=5 AND Overtaking_Lane_changes<=5 AND Cross_c<=5 AND Speed<=5
AND Aggressive_bhvior<=5),
User_information_DNI_id bigint UNSIGNED  NOT NULL ,#Creacion FK (PK_TablaOrigen)
constraint FKdrive_behaviors_car_User_information #FKTabla destino_tabla origen
foreign key(User_information_DNI_id)#PK_tabla origen
references User_information(DNI_id)#Tablaorigen(PK)
On update cascade/*,
user_db_Db_user_id bigint NOT NULL ,#Creacion FK (PK_TablaOrigen)
constraint FKdrive_behaviors_car_user_db #FKTabla destino_tabla origen
foreign key(user_db_Db_user_id)#PK_tabla origen
references user_db(Db_user_id)#Tablaorigen(PK)
On update cascade #Cuidado con ek valor not null del User_db*/
)engine=INNODB;

create table IF NOT exists Drive_Behaviors_car_delta(
OLD_Drive_beh_id bigint UNSIGNED not null,
OLD_Date_evaluation DATE not null,
OLD_Stop_distance int UNSIGNED DEFAULT NULL,
OLD_Roundabouts int UNSIGNED DEFAULT NULL,
OLD_Follow_distance int UNSIGNED DEFAULT NULL,
OLD_Overtaking_Lane_changes int UNSIGNED DEFAULT NULL,
OLD_Cross_c int UNSIGNED DEFAULT NULL,
OLD_Speed int UNSIGNED DEFAULT NULL,
OLD_Aggressive_bhvior int UNSIGNED DEFAULT NULL,
OLD_Result int DEFAULT NULL,
OLD_user_id bigint(10) DEFAULT NULL,
OLD_ws_name varchar(20) DEFAULT NULL,
OLD_Start_date datetime DEFAULT NULL,
OLD_Date_operation timestamp DEFAULT NULL,
OLD_Operation enum("A","U","D") DEFAULT NULL,
OLD_version double DEFAULT NULL,	
OLD_User_information_DNI_id bigint UNSIGNED NOT NULL, #Creacion FK (PK_TablaOrigen)

NEW_Drive_beh_id bigint UNSIGNED not null,
NEW_Date_evaluation DATE not null,
NEW_Stop_distance int UNSIGNED DEFAULT NULL,
NEW_Roundabouts int UNSIGNED DEFAULT NULL,
NEW_Follow_distance int UNSIGNED DEFAULT NULL,
NEW_Overtaking_Lane_changes int UNSIGNED DEFAULT NULL,
NEW_Cross_c int UNSIGNED DEFAULT NULL,
NEW_Speed int UNSIGNED DEFAULT NULL,
NEW_Aggressive_bhvior int UNSIGNED DEFAULT NULL,
NEW_Result int DEFAULT NULL,
NEW_user_id bigint(10) DEFAULT NULL,
NEW_ws_name varchar(20) DEFAULT NULL,
NEW_Start_date datetime DEFAULT NULL,
NEW_Date_operation timestamp DEFAULT NULL,
NEW_Operation enum("A","U","D") DEFAULT NULL,
NEW_version double DEFAULT NULL,	
NEW_User_information_DNI_id bigint UNSIGNED DEFAULT NULL #Creacion FK (PK_TablaOrigen)
)engine=INNODB;


create table IF NOT exists Admin_Country( #Un admin puede tener muchos usuarios y  un usuario solo puede pertenercer a un admin
Admin_id bigint UNSIGNED auto_increment not null,
country_code varchar(3),
admin1 varchar(35),
admin2 varchar(35),
admin3 varchar(35),
admin4 varchar(35),
admin5 varchar(35),

adm1_id bigint UNSIGNED ,
adm2_id bigint UNSIGNED ,
adm3_id bigint UNSIGNED ,
adm4_id bigint UNSIGNED ,
adm5_id bigint UNSIGNED ,
user_id bigint(10) UNSIGNED,
ws_name varchar(20) default "pro_sam_bw19" not null,
Start_date datetime not null DEFAULT CURRENT_TIMESTAMP,
Date_operation timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
Operation enum("A","U","D") default "A" not null,
version double default 1 not null,
primary key(Admin_id)
)engine=INNODB auto_increment 13000;

create table IF NOT exists Drive_Telematics(
Asset_id bigint UNSIGNED auto_increment not null,
lat_start varchar(25),
lon_start varchar (25),
lat_end varchar(25),
lon_end varchar (25),
path_link varchar(250),
Km numeric(19,6),
to_ref_speed_limit numeric(5),
from_ref_speed_limit numeric(5),
Road_class numeric(1),
speed_category varchar(1),
access_autos boolean,
access_motorcycles boolean,
access_taxis boolean,
data3 varchar(25),
data4 varchar(25),
data5 varchar(25),
shape_vector varchar(10000),  # es mu pequeño ,
user_id bigint(10) UNSIGNED,
ws_name varchar(20) default "pro_sam_bw19" not null ,
Start_date datetime not null DEFAULT CURRENT_TIMESTAMP,
Date_operation timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
Operation enum("A","U","D") default "A" not null,
version double default 1 not null,
primary key(Asset_id),
Admin_Country_Admin_id bigint UNSIGNED NOT NULL,#Creacion FK (PK_TablaOrigen)
constraint FKDrive_Telematics_Admin_Country #FKTabla destino_tabla origen
foreign key(Admin_Country_Admin_id)#PK_tabla origen
references Admin_Country(Admin_id)#Tablaorigen(PK)
)engine=INNODB;


create table IF NOT exists Doc_verification(
Doc_id bigint UNSIGNED auto_increment not null,
Valid_licence enum("Y","N"),
Category enum ("A1","A2","B1","B2","B3","C1", "C2" ,"C3","Otro" ) not null,
SOAT enum("Y","N"),
Technom_review enum("Y","N"),
Expi_date date not null,
RUN_State enum("Vigente","Vencida","Suspendida") not null,
accident_rate int  UNSIGNED,
penality_record int  UNSIGNED,
date_penality_1 date,
date_penality_2 date,
date_penality_3 date,
date_penality_4 date,
date_penality_5 date,
Code_penality_1 char(5),
Code_penality_2 char(5),
Code_penality_3 char(5),
Code_penality_4 char(5),
Code_penality_5 char(5),
user_id bigint(10) UNSIGNED,
ws_name varchar(20) default "pro_sam_bw19" not null ,
Start_date datetime not null DEFAULT CURRENT_TIMESTAMP,
Date_operation timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
Operation enum("A","U","D") default "A" not null,
version double default 1 not null,
primary key(Doc_id),
Vehicle_Plate_id varchar(15) UNIQUE NOT NULL ,#Creacion FK (PK_TablaOrigen)
constraint FKDoc_verification_Vehicle #FKTabla destino_tabla origen
foreign key(Vehicle_Plate_id)#PK_tabla origen
references Vehicle(Plate_id),#Tablaorigen(PK)
User_information_DNI_id bigint UNSIGNED UNIQUE NOT NULL ,#Creacion FK (PK_TablaOrigen)
constraint FKDoc_verification_User_information #FKTabla destino_tabla origen
foreign key(User_information_DNI_id)#PK_tabla origen
references User_information(DNI_id)#Tablaorigen(PK)
)engine=INNODB;

create table IF NOT exists Theorical_test(
Test_id bigint UNSIGNED auto_increment not null,
UNIQUE KEY Drive_beh_id (Test_id),
Theoretical_test int UNSIGNED,
Date_evaluation DATE not null,
user_id bigint(10) UNSIGNED,
ws_name varchar(20) default "pro_sam_bw19" not null ,
Date_operation timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
Operation enum("A","U","D") default "A" not null,
version double default 1 not null,
primary key(User_information_DNI_id,Date_evaluation),
User_information_DNI_id bigint UNSIGNED NOT NULL ,#Creacion FK (PK_TablaOrigen)
constraint FKTheorical_test_User_information #FKTabla destino_tabla origen
foreign key(User_information_DNI_id)#PK_tabla origen
references User_information(DNI_id)#Tablaorigen(PK)
)engine=INNODB;
